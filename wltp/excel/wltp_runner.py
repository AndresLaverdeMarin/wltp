#!python#-*- coding: utf-8 -*-"""Sample `xlwings` script####################### The functions included provide for running a batch of experiments in an excel-table with json-pointer paths as headers (see accompanying `wltp_runner.xlsm` file).You can debug it by running it directly as a python script, as suggested by :   http://docs.xlwings.org/debugging.html<< EDIT THIS SCRIPTTO PUT YOUR EXCEL/XLWINGS PYTHON-CODE, BELOW >>"""from __future__ import division, print_function, unicode_literalsimport osimport sysfrom wltp.experiment import Experimentimport pandas as pdimport wltp.pandel as pdlimport xlwings as xwdef add_cycle_run_as_sheet(veh_id, mdl_out):    sheet = "cycle_%s"%veh_id    try:        xw.Sheet.add(sheet)    except Exception as ex:        print("Sheet(%s) already exists(%s)." % (sheet, ex), file=sys.stderr)        xw.Sheet(sheet).clear()    xw.Range(sheet, 'A1').value = mdl_out['cycle_run']        def run_experiments(vehs_df):    """    Iterates `veh_df` and runs experiments.        :param vehs_df:     A dataframe indexed by veh_id, and with columns *json-pointer* paths into the model    """        for veh_id, row in vehs_df.iterrows():        try:            mdl_in = {}            for k, v in row.items():                print((veh_id, k, v), file=sys.stderr)                if isinstance(v, str):                    v = eval(v)                pdl.set_jsonpointer(mdl_in, k, v)            #print((mdl_in), file=sys.stderr)            exp = Experiment(mdl_in)            mdl_out = exp.run()                        add_cycle_run_as_sheet(veh_id, mdl_out)        except Exception as ex:            raise Exception('Veh(%s): %s' % (veh_id, ex)) from ex         def read_table_as_df(range):    """    Expects excel-table with jsonpointer paths as Header and 1st column named `id` as index,     like this::            id     vehicle/test_mass  vehicle/p_rated           vehicle/gear_ratios         veh_1               1500              100  [120.75, 75, 50, 43, 37, 32]         veh_2               1600               80  [120.75, 75, 50, 43, 37, 32]         veh_3               1200               60  [120.75, 75, 50, 43, 37, 32]             """    vehs = xw.Range(range).table.value    vehs = pd.DataFrame(vehs[1:], columns=vehs[0]).set_index('id')        return vehsif __name__ == '__main__':    print(os.getcwd(), file=sys.stderr)    wb_path = os.path.abspath(os.path.join(os.path.dirname(__file__), 'wltp_runner.xlsm'))    xw.Workbook(wb_path)        vehs_df = read_table_as_df('D2')    print(vehs_df, file=sys.stderr)    run_experiments(vehs_df)